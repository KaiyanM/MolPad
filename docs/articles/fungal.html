<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MolPad">
<title>Fungal Garden • MolPad</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fungal Garden">
<meta property="og:description" content="MolPad">
<meta property="og:image" content="https://kaiyanm.github.io/MolPad/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MolPad</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/FAQ.html">FAQ</a>
    <a class="dropdown-item" href="../articles/cheese.html">Cheese</a>
    <a class="dropdown-item" href="../articles/fungal.html">Fungal Garden</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fungal Garden</h1>
            
      
      
      <div class="d-none name"><code>fungal.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kaiyanm.github.io/MolPad/">MolPad</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="load-data">Load Data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h2>
<p>Fungal gardens serve as an external digestive system for the
fungus-growing ant, with mutualistic fungi in the genus Leucoagaricus
converting the plant substrate into energy. This dataset is collected
from soil sample of the fungal garden that gradually infected over time
by a pathogenic fungus, Escovopsis. The goal is to study the dynamic
system and analyzed the bacterial taxa present in this system to capture
the community shifts and map the detected activity in space.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"fungal_garden"</span><span class="op">)</span></span>
<span><span class="co"># 'fungal_garden' is a list of 3:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fungal_dlist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;       ID      D0_01     D1_02      D2_03     D3_04     D4_05     D5_06</span></span>
<span><span class="co">#&gt; 1 grp1_1 -0.9533405 -1.106882 -0.7821818 -2.344134 -2.213369 -1.846307</span></span>
<span><span class="co">#&gt; 2 grp1_2 -0.9533405 -1.106882 -0.7821818 -1.740328 -1.983804 -1.910560</span></span>
<span><span class="co">#&gt; 3 grp1_6  0.9672390  1.351778  1.2871986  1.306616  1.253802  1.228330</span></span>
<span><span class="co">#&gt;       D6_07     D7_08     D8_09     D9_10    D10_11</span></span>
<span><span class="co">#&gt; 1 -2.019264 -1.653271 -1.855675 -1.856335 -2.675131</span></span>
<span><span class="co">#&gt; 2 -2.360466 -1.728546 -2.204190 -2.552709 -3.220536</span></span>
<span><span class="co">#&gt; 3  1.522306  1.381057  1.512031  1.391325  1.297332</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fungal_dlist</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;       ID       D0_01       D1_02        D2_03       D3_04        D4_05</span></span>
<span><span class="co">#&gt; 1 grp2_1  0.07955562 -0.06847126 -0.085804628 -0.06970496 -0.189086831</span></span>
<span><span class="co">#&gt; 2 grp2_2  0.14481731  0.63121925  0.640259446  0.53728726  0.003337022</span></span>
<span><span class="co">#&gt; 3 grp2_3 -0.71104811 -0.03273029  0.007307968  0.15272255  0.151116165</span></span>
<span><span class="co">#&gt;         D5_06       D6_07      D7_08      D8_09      D9_10     D10_11</span></span>
<span><span class="co">#&gt; 1 -0.01056197 -0.30973183 -0.1719941 -0.1238594 -0.2293862  0.1021993</span></span>
<span><span class="co">#&gt; 2 -0.20361189  0.62014296  0.9765937  1.0188160  0.8699408  0.3023357</span></span>
<span><span class="co">#&gt; 3  0.04532175  0.09048819  0.3211153  0.3079252  0.2960252 -0.4230718</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fungal_dlist</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;       ID      D0_01      D1_02     D2_03      D3_04      D4_05      D5_06</span></span>
<span><span class="co">#&gt; 1 grp3_1 -0.4702515 -0.3390523 -0.501346 -0.4833872 -0.4902185 -0.6680519</span></span>
<span><span class="co">#&gt; 2 grp3_2 -1.6644934 -2.6212720 -2.283416 -1.8775744 -0.6482506 -1.5863859</span></span>
<span><span class="co">#&gt; 3 grp3_3 -0.9248744 -0.6240496 -0.552006 -0.2821400 -0.3161406 -0.3980750</span></span>
<span><span class="co">#&gt;        D6_07      D7_08      D8_09      D9_10     D10_11</span></span>
<span><span class="co">#&gt; 1 -0.6609125 -0.7754728 -0.7022775 -0.5814545 -0.1418371</span></span>
<span><span class="co">#&gt; 2 -1.7470608 -0.3588664 -1.0980109 -1.7763473 -0.4198883</span></span>
<span><span class="co">#&gt; 3 -0.3106139 -0.2878704 -0.2226940 -0.1963857  0.4274527</span></span>
<span><span class="co"># 'pathway' has all the annotation information</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pathway</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;        ID taxonomic.scope ko_term              Pathway</span></span>
<span><span class="co">#&gt; 1 grp1_24        Bacteria  K02706 00195_Photosynthesis</span></span>
<span><span class="co">#&gt; 2 grp1_25        Bacteria  K02706 00195_Photosynthesis</span></span>
<span><span class="co">#&gt; 3 grp1_26        Bacteria  K02706 00195_Photosynthesis</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="preprocess">Preprocess<a class="anchor" aria-label="anchor" href="#preprocess"></a>
</h2>
<div class="section level3">
<h3 id="data-input">data input<a class="anchor" aria-label="anchor" href="#data-input"></a>
</h3>
<p>We first reshape the datalist into our standard format. The type
column is to describe datasets from the input, and if not specified, the
type will be auto-filled with “dataset 1”, “dataset 2”, etc.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pre_process.html">pre_process</a></span><span class="op">(</span><span class="va">fungal_dlist</span>,typenameList <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Peptide"</span>,<span class="st">"Metabolite"</span>,<span class="st">"Lipid"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Reformat a list of datasets:"</span></span>
<span><span class="co"># The following dataset is our standard input:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">a</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;       ID     D0_01     D1_02      D2_03       D3_04      D4_05       D5_06</span></span>
<span><span class="co">#&gt; 1 grp1_1  1.350981 1.0922535  1.6393933 -0.99258979 -0.7722424 -0.15372092</span></span>
<span><span class="co">#&gt; 2 grp1_2  1.255873 1.0449588  1.4909861  0.17482077 -0.1596318 -0.05901949</span></span>
<span><span class="co">#&gt; 3 grp1_6 -2.330833 0.2237842 -0.2052373 -0.07624194 -0.4271007 -0.59632291</span></span>
<span><span class="co">#&gt;        D6_07     D7_08      D8_09      D9_10     D10_11      type</span></span>
<span><span class="co">#&gt; 1 -0.4451639 0.1715562 -0.1695078 -0.1706187 -1.5503401 Dataset_1</span></span>
<span><span class="co">#&gt; 2 -0.6770360 0.1910056 -0.4623665 -0.9411120 -1.8584783 Dataset_1</span></span>
<span><span class="co">#&gt; 3  1.3566591 0.4182970  1.2884006  0.4865118 -0.1379168 Dataset_1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="cluster-input">cluster input<a class="anchor" aria-label="anchor" href="#cluster-input"></a>
</h3>
<p>Then we generate clusters from the long dataset above. The number of
clusters can be adjusted according to the elbow method plot in
<code>b[[2]]</code>, where we picked one close to the inflection
point.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gClusters.html">gClusters</a></span><span class="op">(</span><span class="va">a</span>,ncluster <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="co">#b[[1]] has all the cluster level information, includes: cluster, center, totss, withinss, betweens, size, iter, and ifault.</span></span>
<span><span class="co">#b[[2]] is the WSS plot for different number of clusters.</span></span>
<span><span class="va">b</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="fungal_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="network-input">network input<a class="anchor" aria-label="anchor" href="#network-input"></a>
</h3>
<p>After that, we got the network result from the clusters. We pick top
5 predictors for each feature, and save the network output for future
use.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">networkres</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gNetwork.html">gNetwork</a></span><span class="op">(</span><span class="va">b</span>,ntop <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>Users could also view more details of the results with the following
function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gNetwork_view.html">gNetwork_view</a></span><span class="op">(</span><span class="va">networkres</span><span class="op">)</span></span></code></pre></div>
<p><img src="fungal_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="run-dashboard">Run Dashboard<a class="anchor" aria-label="anchor" href="#run-dashboard"></a>
</h2>
<p>Name the title and declare the annotation, and then run the
dashboard.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gDashboard.html">gDashboard</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span>,<span class="va">pathway</span>,<span class="va">networkres</span>,</span>
<span>           dashboardtitle <span class="op">=</span> <span class="st">"MolPad Dashboard"</span>,</span>
<span>           id_colname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GO_ID"</span>,<span class="st">"KEGG_ID"</span><span class="op">)</span>,</span>
<span>           id_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GO"</span>,<span class="st">"KEGG"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
